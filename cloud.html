<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flight Deck: 5-Point Cloud Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        .sortable-ghost { opacity: 0.3; background: #dbeafe !important; border: 2px dashed #2563eb !important; }
        .sortable-drag { opacity: 1; transform: rotate(2deg) scale(1.05); box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1); }
        .drop-slot:empty::before {
            content: "DRAG METAR";
            font-size: 9px; font-weight: 800; color: #cbd5e1;
            display: flex; justify-content: center; align-items: center; height: 100%;
        }
    </style>
</head>
<body class="bg-slate-100 p-4 font-sans">

    <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-2xl overflow-hidden border border-slate-200">
        <div class="bg-slate-900 p-6 text-white border-b-4 border-blue-600">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-black tracking-tighter uppercase italic text-blue-400">Meteorology: Quick Check</h1>
                    <p class="text-slate-400 text-xs mt-1 font-mono">TASK: IDENTIFY 5 RANDOM FORMATIONS</p>
                </div>
                <div class="text-right">
                    <span id="score-pill" class="text-[10px] font-mono border border-slate-700 px-2 py-1 rounded bg-slate-800 text-slate-300 uppercase tracking-widest">Pre-flight Mode</span>
                </div>
            </div>
        </div>

        <div class="p-6">
            <div class="mb-8 p-4 bg-slate-50 rounded-lg border border-slate-200">
                <h2 class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mb-4 text-center text-blue-600">Drag Identifiers Below</h2>
                <div id="cloud-pool" class="flex flex-wrap justify-center gap-3 min-h-[50px]"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="target-grid"></div>

            <div class="mt-10 pt-6 border-t border-slate-200">
                <div id="feedback-panel" class="hidden mb-6 p-4 rounded-lg border text-sm"></div>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button id="submit-btn" onclick="checkAnswers()" class="bg-blue-600 hover:bg-blue-700 text-white px-12 py-4 rounded font-black uppercase tracking-widest transition shadow-lg active:scale-95">Verify Identification</button>
                    <button onclick="window.location.reload()" class="bg-slate-200 hover:bg-slate-300 text-slate-700 px-8 py-4 rounded font-bold uppercase tracking-widest transition">Next 5 Clouds</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const masterCloudData = [
            { id: 'CI', name: 'Cirrus', level: 'High (>20k ft)', desc: 'Thin, wispy "mare\'s tails".', tip: 'CI is usually harmless but indicates high-level moisture trends.' },
            { id: 'CC', name: 'Cirrocumulus', level: 'High (>20k ft)', desc: 'Small white ripples or grains.', tip: 'CC indicates instability at high altitudes; often associated with turbulence.' },
            { id: 'CS', name: 'Cirrostratus', level: 'High (>20k ft)', desc: 'Transparent veil often producing a halo.', tip: 'CS precedes a warm front. The halo is caused by ice crystals.' },
            { id: 'AC', name: 'Altocumulus', level: 'Mid (6.5k-20k ft)', desc: 'White/gray patches or "mackerel scales".', tip: 'AC indicates instability. Watch for structural icing in these layers.' },
            { id: 'ACC', name: 'ACC (Castellanus)', level: 'Mid (6.5k-20k ft)', desc: 'Vertical turrets sprouting from mid-clouds.', tip: 'ACC is a significant warning of potential convective activity and storms.' },
            { id: 'AS', name: 'Altostratus', level: 'Mid (6.5k-20k ft)', desc: 'Blue-gray sheet, sun appears as a watery disk.', tip: 'AS indicates thickening moisture; light to moderate icing is common.' },
            { id: 'ST', name: 'Stratus', level: 'Low (SFC-6.5k ft)', desc: 'Uniform gray layer resembling high fog.', tip: 'ST leads to low ceilings and poor visibility. Stable but IFR.' },
            { id: 'SC', name: 'Stratocumulus', level: 'Low (SFC-6.5k ft)', desc: 'Lumpy, rounded masses in a layer.', tip: 'SC produces light turbulence but is usually non-precipitating.' },
            { id: 'NS', name: 'Nimbostratus', level: 'Low/Mid (Thick)', desc: 'Dark, wet-looking layer with steady rain.', tip: 'NS means poor visibility and serious icing potential. The "Rain Cloud".' },
            { id: 'CU', name: 'Cumulus', level: 'Low (SFC-6.5k ft)', desc: 'Puffy, white cotton balls with flat bases.', tip: 'CU indicates convective lift. Expect turbulence beneath cloud bases.' },
            { id: 'CF', name: 'Cumulus Fractus', level: 'Low (SFC-6.5k ft)', desc: 'Ragged, torn fragments ("scud").', tip: 'CF often forms in humid air beneath other precipitating clouds.' },
            { id: 'TCU', name: 'Towering Cumulus', level: 'Vertical Growth', desc: 'Cauliflower-like height, heavy density.', tip: 'TCU indicates strong updrafts. It is the active precursor to a CB.' },
            { id: 'CB', name: 'Cumulonimbus', level: 'Severe Vertical', desc: 'Anvil-topped giant thunderstorm.', tip: 'CB = Severe hazard. Icing, hail, and extreme turbulence. Avoid by 20NM.' }
        ];

        let activeSet = [];
        const pool = document.getElementById('cloud-pool');
        const grid = document.getElementById('target-grid');

        function init() {
            // Randomly pick 5 clouds
            activeSet = [...masterCloudData].sort(() => Math.random() - 0.5).slice(0, 5);
            
            // Render Target Zones
            activeSet.forEach(cloud => {
                const card = document.createElement('div');
                card.className = "bg-white border border-slate-200 rounded-lg p-4 flex flex-col shadow-sm";
                card.innerHTML = `
                    <div class="mb-3">
                        <span class="text-[9px] font-black bg-blue-50 text-blue-600 px-2 py-0.5 rounded uppercase border border-blue-100">${cloud.level}</span>
                        <p class="text-[12px] text-slate-600 mt-2 font-medium italic leading-relaxed">"${cloud.desc}"</p>
                    </div>
                    <div class="drop-slot bg-slate-50 border-2 border-dashed border-slate-200 rounded-md min-h-[50px]" data-correct="${cloud.id}"></div>
                `;
                grid.appendChild(card);
            });

            // Render Identifiers in pool
            [...activeSet].sort(() => Math.random() - 0.5).forEach(cloud => {
                const item = document.createElement('div');
                item.className = "draggable-item bg-slate-800 text-white px-5 py-2 rounded shadow-md text-sm font-black cursor-grab active:cursor-grabbing select-none border border-slate-700 hover:bg-slate-700";
                item.setAttribute('data-id', cloud.id);
                item.innerText = cloud.id;
                pool.appendChild(item);
            });

            // Init Sortable
            new Sortable(pool, { group: 'clouds', animation: 150, ghostClass: 'sortable-ghost', dragClass: 'sortable-drag' });
            document.querySelectorAll('.drop-slot').forEach(slot => {
                new Sortable(slot, {
                    group: 'clouds', animation: 150,
                    onAdd: function (evt) { if (evt.to.children.length > 1) pool.appendChild(evt.item); }
                });
            });
        }

        function checkAnswers() {
            const slots = document.querySelectorAll('.drop-slot');
            let correct = 0;
            let issues = [];

            slots.forEach(slot => {
                const item = slot.querySelector('.draggable-item');
                const correctId = slot.getAttribute('data-correct');
                const data = masterCloudData.find(c => c.id === correctId);

                if (item && item.getAttribute('data-id') === correctId) {
                    slot.parentElement.className = "bg-green-50 border border-green-500 rounded-lg p-4 flex flex-col shadow-sm";
                    correct++;
                } else {
                    slot.parentElement.className = "bg-red-50 border border-red-500 rounded-lg p-4 flex flex-col shadow-sm";
                    issues.push(`<strong>${data.name} (${data.id}):</strong> ${data.tip}`);
                }
            });

            const panel = document.getElementById('feedback-panel');
            const scorePill = document.getElementById('score-pill');
            panel.classList.remove('hidden');
            
            scorePill.innerText = `Score: ${correct} / 5`;
            
            if (correct === 5) {
                panel.className = "mb-6 p-4 rounded-lg bg-green-100 border border-green-300 text-green-800 font-bold text-center";
                panel.innerHTML = "Checkride Passed! Perfect identification of this weather set.";
            } else {
                panel.className = "mb-6 p-4 rounded-lg bg-amber-50 border border-amber-200 text-amber-900";
                panel.innerHTML = `<p class="font-bold mb-2 underline text-red-700">Flight Debrief:</p><ul class="list-disc ml-5 space-y-2">${issues.map(i => `<li>${i}</li>`).join('')}</ul>`;
            }
        }
        init();
    </script>
</body>
</html>